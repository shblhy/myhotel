;(function(A){function _(_,$){var B=A(_).text().toUpperCase(),C=A($).text().toUpperCase();return(B<C)?-1:(B>C)?1:0}var $={init:function(B){var $={selectedPosition:"right",moveOptions:true,labelTop:"\u7f6e\u9876",labelBottom:"\u7f6e\u5e95",labelUp:"\u4e0a\u79fb",labelDown:"\u4e0b\u79fb",labelSort:"\u987a\u6392",leftContainer:"",labelsx:"\u53ef\u9009",rightContainer:"",labeldx:"\u5df2\u9009",maxSelected:-1,autoSort:false,autoSortAvailable:false,search:false,caseSensitive:false,delay:200,optGroupSearch:false,minSize:6};return this.each(function(){var N=A(this),E=N.data("multiselect2side");if(B)A.extend($,B);if(!E)N.data("multiselect2side",$);var F=A(this).attr("name");if(F.indexOf("[")!=-1)F=F.substring(0,F.indexOf("["));var C=F+"ms2side__dx",I=F+"ms2side__sx",J=A(this).attr("size");if(J<$.minSize){A(this).attr("size",""+$.minSize);J=$.minSize}var G="<div class='ms2side__updown'>"+"<p class='SelSort' title='\u6309\u987a\u5e8f\u6392\u5217'>"+$.labelSort+"</p>"+"<p class='MoveTop' title='\u6392\u5728\u9996\u4f4d'>"+$.labelTop+"</p>"+"<p class='MoveUp' title='\u4e0a\u79fb\u4e00\u4f4d'>"+$.labelUp+"</p>"+"<p class='MoveDown' title='\u4e0b\u79fb\u4e00\u4f4d'>"+$.labelDown+"</p>"+"<p class='MoveBottom' title='\u6392\u5728\u5e95\u90e8'>"+$.labelBottom+"</p>"+"</div>",L=false,X=false;if($.search!=false&&$.optGroupSearch!=false){var S=$.optGroupSearch+"<select class='small' ><option value=__null__> </option></select> "+$.search+"<input class='small searchInput' type='text' /><a href='#'> </a>";if($.selectedPosition=="right")L=S;else X=S}else if($.search!=false){S=$.search+"<input class='searchInput' type='text' /><a href='#'> </a>";if($.selectedPosition=="right")L=S;else X=S}else if($.optGroupSearch!=false){S=$.optGroupSearch+"<select><option value=__null__> </option></select>";if($.selectedPosition=="right")L=S;else X=S}var T="<div class='ms2side__div'>"+(($.selectedPosition!="right"&&$.moveOptions)?G:"")+"<div class='ms2side__select'>"+($.leftContainer?("<div class='ms2side__header'>"+$.leftContainer+"</div>"):(($.labelsx||L!=false)?("<div class='ms2side__header'>"+(L!=false?L:$.labelsx)+"</div>"):""))+"<select title='"+$.labelsx+"' name='"+I+"' id='"+I+"' size='"+J+"' multiple='multiple' ></select>"+"</div>"+"<div class='ms2side__options'>"+(($.selectedPosition=="right")?("<p class='AddOne' title='\u6dfb\u52a0\u9009\u4e2d'>&rsaquo;</p>"+"<p class='AddAll' title='\u6dfb\u52a0\u5168\u90e8'>&raquo;</p>"+"<p class='RemoveOne' title='\u79fb\u9664\u9009\u4e2d'>&lsaquo;</p>"+"<p class='RemoveAll' title='\u79fb\u9664\u5168\u90e8'>&laquo;</p>"):("<p class='AddOne' title='\u6dfb\u52a0\u9009\u4e2d'>&lsaquo;</p>"+"<p class='AddAll' title='\u6dfb\u52a0\u5168\u90e8'>&laquo;</p>"+"<p class='RemoveOne' title='\u79fb\u9664\u9009\u4e2d'>&rsaquo;</p>"+"<p class='RemoveAll' title='\u79fb\u9664\u5168\u90e8'>&raquo;</p>"))+"</div>"+"<div class='ms2side__select'>"+($.rightContainer?("<div class='ms2side__header'>"+$.rightContainer+"</div>"):(($.labeldx||X!=false)?("<div class='ms2side__header'>"+(X!=false?X:$.labeldx)+"</div>"):""))+"<select title='"+$.labeldx+"' name='"+C+"' id='"+C+"' size='"+J+"' multiple='multiple' ></select>"+"</div>"+(($.selectedPosition=="right"&&$.moveOptions)?G:"")+"</div>";N.after(T).hide();var U=N.next().children(".ms2side__select").children("select"),O=($.selectedPosition=="right")?U.eq(0):U.eq(1),K=($.selectedPosition=="right")?U.eq(1):U.eq(0),R=A(".ms2side__select").eq(0).height(),Z=A(),D=A(this).next().find("input:text.searchInput"),W=D.next().hide(),Y=false,Q=false;if($.optGroupSearch!=false){var H=false;Z=A(this).next().find("select").eq(0);N.children("optgroup").each(function(){if(Z.find("[value='"+A(this).attr("label")+"']").size()==0)Z.append("<option value='"+A(this).attr("label")+"'>"+A(this).attr("label")+"</option>")});Z.change(function(){var $=A(this);if($.val()!=H){if(D.val()!=""){clearTimeout(Y);W.hide();D.val("");Q=""}setTimeout(function(){if($.val()=="__null__")els=N.find("option:not(:selected)");else els=N.find("optgroup[label='"+$.val()+"']").children("option:not(:selected)");O.find("option").remove();els.each(function(){O.append(A(this).clone())});H=$.val();O.trigger("change")},100)}})}var M=function(){var B=O.children(),_=N.find("option:not(:selected)");H="__null__";Z.val("__null__");if(Q==D.val())return;D.addClass("wait").removeAttr("style");Q=D.val();setTimeout(function(){O.children().remove();if(Q==""){_.clone().appendTo(O).removeAttr("selected");W.hide()}else{_.each(function(){var _=A(this).text();if($.caseSensitive)find=_.indexOf(Q);else find=_.toUpperCase().indexOf(Q.toUpperCase());if(find!=-1)A(this).clone().appendTo(O).removeAttr("selected")});if(O.children().length==0)D.css({"border":"1px red solid"});W.show();O.trigger("change")}O.trigger("change");D.removeClass("wait")},5)};W.click(function(){clearTimeout(Y);D.val("");M();return false});D.keyup(function(){clearTimeout(Y);Y=setTimeout(M,$.delay)});A(this).next().find(".ms2side__options, .ms2side__updown").each(function(){var $=((R/2)-(A(this).height()/2));if($>0)A(this).css("padding-top",$+"px")});A(this).find("option:selected").clone().appendTo(K);A(this).find("option:not(:selected)").clone().appendTo(O);if(!(A.browser.msie&&A.browser.version=="6.0")){O.find("option").eq(0).attr("selected",true);K.children().removeAttr("selected")}var V=0;if($.autoSort)U.change(function(){var $=K.find("option");if($.length!=V){$.sort(_);N.find("option:selected").remove();$.each(function(){K.append(A(this).clone());A(this).appendTo(N).attr("selected",true)});V=$.length}});var P=0;if($.autoSortAvailable)U.change(function(){var $=O.find("option");if($.length!=P){$.sort(_);O.find("option").remove();$.each(function(){O.append(A(this).clone())});P=$.length}});U.change(function(){if(A.browser.msie&&A.browser.version=="6.0")N.show().hide();var C=A(this).parent().parent(),E=O.children(),_=K.children(),D=O.find("option:selected"),B=K.find("option:selected");if(D.size()==0||($.maxSelected>=0&&(D.size()+_.size())>$.maxSelected))C.find(".AddOne").addClass("ms2side__hide");else C.find(".AddOne").removeClass("ms2side__hide");C.find(".RemoveOne, .MoveUp, .MoveDown, .MoveTop, .MoveBottom, .SelSort").addClass("ms2side__hide");if(_.size()>1)C.find(".SelSort").removeClass("ms2side__hide");if(B.size()>0){C.find(".RemoveOne").removeClass("ms2side__hide");if(B.size()<_.size()){if(B.val()!=_.val())C.find(".MoveUp, .MoveTop").removeClass("ms2side__hide");if(B.last().val()!=_.last().val())C.find(".MoveDown, .MoveBottom").removeClass("ms2side__hide")}}if(E.size()==0||($.maxSelected>=0&&E.size()>=$.maxSelected))C.find(".AddAll").addClass("ms2side__hide");else C.find(".AddAll").removeClass("ms2side__hide");if(_.size()==0)C.find(".RemoveAll").addClass("ms2side__hide");else C.find(".RemoveAll").removeClass("ms2side__hide")});O.dblclick(function(){A(this).find("option:selected").each(function(B,_){if($.maxSelected<0||K.children().size()<$.maxSelected){A(this).remove().appendTo(K);N.find("[value='"+A(_).val()+"']").remove().appendTo(N).attr("selected",true)}});A(this).trigger("change")});K.dblclick(function(){A(this).find("option:selected").each(function(_,$){A(this).remove().appendTo(O);N.find("[value='"+A($).val()+"']").removeAttr("selected").remove().appendTo(N)});A(this).trigger("change");Z.val("__null__").trigger("change");W.click()});A(this).next().find(".ms2side__options").children().click(function(){if(!A(this).hasClass("ms2side__hide"))if(A(this).hasClass("AddOne"))O.find("option:selected").each(function(_,$){A(this).remove().appendTo(K);N.find("[value='"+A($).val()+"']").remove().appendTo(N).attr("selected",true)});else if(A(this).hasClass("AddAll")){if(W.is(":visible")||(Z.length>0&&Z.val()!="__null__"))O.children().each(function(_,$){A(this).remove().appendTo(K);N.find("[value='"+A($).val()+"']").remove().appendTo(N).attr("selected",true)});else{O.children().remove().appendTo(K);N.find("option").attr("selected",true)}}else if(A(this).hasClass("RemoveOne")){K.find("option:selected").each(function(_,$){A(this).remove().appendTo(O);N.find("[value='"+A($).val()+"']").remove().appendTo(N).removeAttr("selected")});W.click();Z.val("__null__").trigger("change")}else if(A(this).hasClass("RemoveAll")){K.children().appendTo(O);K.children().remove();N.find("option").removeAttr("selected");W.click();Z.val("__null__").trigger("change")}O.trigger("change")});A(this).next().find(".ms2side__updown").children().click(function(){var E=K.find("option:selected"),$=K.find("option");if(!A(this).hasClass("ms2side__hide"))if(A(this).hasClass("SelSort")){$.sort(_);N.find("option:selected").remove();$.each(function(){K.append(A(this).clone().attr("selected",true));N.append(A(this).attr("selected",true))})}else if(A(this).hasClass("MoveUp")){var J=E.first().prev(),B=N.find("[value='"+J.val()+"']");E.each(function(){A(this).insertBefore(J);N.find("[value='"+A(this).val()+"']").insertBefore(B)})}else if(A(this).hasClass("MoveDown")){var D=E.last().next(),I=N.find("[value='"+D.val()+"']");E.each(function(){A(this).insertAfter(D);N.find("[value='"+A(this).val()+"']").insertAfter(I)})}else if(A(this).hasClass("MoveTop")){var G=$.first(),F=N.find("[value='"+G.val()+"']");E.each(function(){A(this).insertBefore(G);N.find("[value='"+A(this).val()+"']").insertBefore(F)})}else if(A(this).hasClass("MoveBottom")){var C=$.last(),H=N.find("[value='"+C.val()+"']");E.each(function(){C=A(this).insertAfter(C);H=N.find("[value='"+A(this).val()+"']").insertAfter(H)})}O.trigger("change")});A(this).next().find(".ms2side__options, .ms2side__updown").children().hover(function(){A(this).addClass("ms2side_hover")},function(){A(this).removeClass("ms2side_hover")});O.trigger("change");A(this).next().show()})},destroy:function(){return this.each(function(){var $=A(this),_=$.data("multiselect2side");if(!_)return;$.show().next().remove()})},addOption:function(_){var $={name:false,value:false,selected:false};return this.each(function(){var D=A(this),F=D.data("multiselect2side");if(!F)return;if(_)A.extend($,_);var C="<option value='"+$.value+"' "+($.selected?"selected":"")+" >"+$.name+"</option>";D.append(C);var G=D.next().children(".ms2side__select").children("select"),E=(F.selectedPosition=="right")?G.eq(0):G.eq(1),B=(F.selectedPosition=="right")?G.eq(1):G.eq(0);if($.selected)B.append(C).trigger("change");else E.append(C).trigger("change")})}};A.fn.multiselect2side=function(_){if($[_])return $[_].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof _==="object"||!_)return $.init.apply(this,arguments);else A.error("Method "+_+" does not exist on jQuery.multiselect2side")}})(jQuery)